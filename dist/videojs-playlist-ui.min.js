/*! @name videojs-playlist-ui @version 3.4.2 @license Apache-2.0 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("global/document"),require("video.js")):"function"==typeof define&&define.amd?define(["global/document","video.js"],e):t.videojsPlaylistUi=e(t.document,t.videojs)}(this,function(t,e){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var i,l=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},n=(e=e&&e.hasOwnProperty("default")?e.default:e).dom||e,r=e.registerPlugin||e.plugin,o={className:"vjs-playlist",playOnSelect:!1,supportsCssPointerEvents:((i=t.createElement("x")).style.cssText="pointer-events:auto","auto"===i.style.pointerEvents)},p=function(t){t.addClass("vjs-selected")},c=function(t){t.removeClass("vjs-selected"),t.thumbnail&&n.removeClass(t.thumbnail,"vjs-playlist-now-playing")},d=function(t){t.removeClass("vjs-up-next")},h=e.getComponent("Component"),u=function(i){function n(t,e,a){if(l(this,n),!e.item)throw new Error("Cannot construct a PlaylistMenuItem without an item option");var r=s(this,i.call(this,t,e));return r.item=e.item,r.playOnSelect=a.playOnSelect,r.emitTapEvents(),r.on(["click","tap"],r.switchPlaylistItem_),r.on("keydown",r.handleKeyDown_),r}return a(n,i),n.prototype.handleKeyDown_=function(t){13!==t.which&&32!==t.which||this.switchPlaylistItem_()},n.prototype.switchPlaylistItem_=function(t){this.player_.playlist.currentItem(function(t,e){for(var i=0,l=t.length;i<l;i++)if(t[i]===e)return i;return-1}(this.player_.playlist(),this.item)),this.playOnSelect&&this.player_.play()},n.prototype.createEl=function(){var i=t.createElement("li"),l=this.options_.item;if(l.data){var a=Object.entries(l.data);a.length>0&&a.forEach(function(t){var e=t[0],l=t[1];i.setAttribute("data-"+e,l)})}if(i.className="vjs-playlist-item",i.setAttribute("tabIndex",0),this.thumbnail=function(e){if(!e){var i=t.createElement("div");return i.className="vjs-playlist-thumbnail vjs-playlist-thumbnail-placeholder",i}var l=t.createElement("picture");if(l.className="vjs-playlist-thumbnail","string"==typeof e){var a=t.createElement("img");a.src=e,a.alt="",l.appendChild(a)}else{for(var s=0;s<e.length-1;s++){var n=e[s],r=t.createElement("source");for(var o in n)r[o]=n[o];l.appendChild(r)}var p=e[e.length-1],c=t.createElement("img");for(var d in c.alt="",p)c[d]=p[d];l.appendChild(c)}return l}(l.thumbnail),i.appendChild(this.thumbnail),l.duration){var s=t.createElement("time"),n=e.formatTime(l.duration);s.className="vjs-playlist-duration",s.setAttribute("datetime","PT0H0M"+l.duration+"S"),s.appendChild(t.createTextNode(n)),i.appendChild(s)}var r=t.createElement("span"),o=this.localize("Now Playing");r.className="vjs-playlist-now-playing-text",r.appendChild(t.createTextNode(o)),r.setAttribute("title",o),this.thumbnail.appendChild(r);var p=t.createElement("div");p.className="vjs-playlist-title-container",this.thumbnail.appendChild(p);var c=t.createElement("span"),d=this.localize("Up Next");c.className="vjs-up-next-text",c.appendChild(t.createTextNode(d)),c.setAttribute("title",d),p.appendChild(c);var h=t.createElement("cite"),u=l.name||this.localize("Untitled Video");return h.className="vjs-playlist-name",h.appendChild(t.createTextNode(u)),h.setAttribute("title",u),p.appendChild(h),i},n}(h),y=function(i){function r(t,a){if(l(this,r),!t.playlist)throw new Error("videojs-playlist is required for the playlist component");var n=s(this,i.call(this,t,a));return n.items=[],a.horizontal?n.addClass("vjs-playlist-horizontal"):n.addClass("vjs-playlist-vertical"),a.supportsCssPointerEvents&&n.addClass("vjs-csspointerevents"),n.createPlaylist_(),e.browser.TOUCH_ENABLED||n.addClass("vjs-mouse"),t.on(["loadstart","playlistchange","playlistsorted"],function(t){n.update()}),t.on("adstart",function(){n.addClass("vjs-ad-playing")}),t.on("adend",function(){n.removeClass("vjs-ad-playing")}),n}return a(r,i),r.prototype.createEl=function(){return n.createEl("div",{className:this.options_.className})},r.prototype.createPlaylist_=function(){var e=this.player_.playlist()||[],i=this.el_.querySelector(".vjs-playlist-item-list"),l=this.el_.querySelector(".vjs-playlist-ad-overlay");i||((i=t.createElement("ol")).className="vjs-playlist-item-list",this.el_.appendChild(i));for(var a=0;a<this.items.length;a++)i.removeChild(this.items[a].el_);this.items.length=0;for(var s=0;s<e.length;s++){var r=new u(this.player_,{item:e[s]},this.options_);this.items.push(r),i.appendChild(r.el_)}l?i.appendChild(l):((l=t.createElement("li")).className="vjs-playlist-ad-overlay",i.appendChild(l));var o=this.player_.playlist.currentItem();if(this.items.length&&o>=0){p(this.items[o]);var c=this.items[o].$(".vjs-playlist-thumbnail");c&&n.addClass(c,"vjs-playlist-now-playing")}},r.prototype.update=function(){var e=this.player_.playlist();if(this.items.length===e.length){for(var i=0;i<this.items.length;i++)if(this.items[i].item!==e[i])return void this.createPlaylist_();for(var l=this.player_.playlist.currentItem(),a=0;a<this.items.length;a++){var s=this.items[a];a===l?(p(s),t.activeElement!==s.el()&&n.addClass(s.thumbnail,"vjs-playlist-now-playing"),d(s)):a===l+1?(c(s),s.addClass("vjs-up-next")):(c(s),d(s))}}else this.createPlaylist_()},r}(h),m=function(t){for(var e=0;e<t.childNodes.length;e++)if(n.isEl(t.childNodes[e]))return!0;return!1},v=function(i){if(!this.playlist)throw new Error("videojs-playlist plugin is required by the videojs-playlist-ui plugin");if(n.isEl(i)&&(e.log.warn('videojs-playlist-ui: Passing an element directly to playlistUi() is deprecated, use the "el" option instead!'),i={el:i}),i=e.mergeOptions(o,i),this.playlistMenu){var l=this.playlistMenu.el();if(l){var a=l.parentNode,s=l.nextSibling;this.playlistMenu.dispose(),n.emptyEl(l),s?a.insertBefore(l,s):a.appendChild(l),i.el=l}}n.isEl(i.el)||(i.el=function(e){for(var i=t.querySelectorAll("."+e),l=void 0,a=0;a<i.length;a++)if(!m(i[a])){l=i[a];break}return l}(i.className)),this.playlistMenu=new y(this,i)};return e.registerComponent("PlaylistMenu",y),e.registerComponent("PlaylistMenuItem",u),r("playlistUi",v),v.VERSION="3.4.2",v});
